<!DOCTYPE html>
<html>
<head>
	<title>WebGL Bilateral Transform</title>

	</head>
<body>
	<canvas id="canvas" width="800" height="600"></canvas>

	<script id="bilateral-vs" type="x-shader/x-vertex">
		precision mediump float;
		
		attribute vec2 a_position;
		
		varying vec2 v_texCoord;

		void main() {
			gl_Position = vec4((a_position * 2.0 - 1.0) * vec2(1.0,-1.0),0,1);
			v_texCoord = a_position;
		}
	</script>
	<script id="bilateral-fs" type="x-shader/x-fragment">
		precision mediump float;

		uniform vec2 u_resolution;
		uniform sampler2D u_image;
		uniform sampler2D u_mask;

		varying vec2 v_texCoord;

		const int c_winSize = 5;

		void main() {
			//gl_FragColor = vec4(0,1,0,1);
			vec2 pixSize = 1.0 / u_resolution;
			vec4 color = vec4(0,0,0,0);
			for (int x = -1 * c_winSize / 2; x <= c_winSize / 2; x++) {
				for (int y = -1 * c_winSize / 2; y <= c_winSize / 2; y++) {
					vec2 texCoord = v_texCoord + vec2(x,y) * pixSize;
					vec2 maskCoord = vec2(x,y) / vec2(c_winSize,c_winSize) + vec2(0.5,0.5);
					color += texture2D(u_image, texCoord) * texture2D(u_mask,maskCoord);
				}
			}
			//gl_FragColor = texture2D(u_image, v_texCoord);
			gl_FragColor = color;
		}
  
	</script>
	<!-- bower:js -->
	<!-- endbower -->

	<script src="scripts/gaussian.js"></script>
	<script src="scripts/main.js"></script>


</body>
</html>
